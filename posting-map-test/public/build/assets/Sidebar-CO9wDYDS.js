import{K as m,r as o,j as e,S as b}from"./app-Cqn3qS6T.js";import g from"./Map-eb66i1bk.js";import"./index-uETJ-Win.js";const v=()=>{m().props.auth.user;const{auth:c}=m().props,[r,i]=o.useState(new Set),[n,x]=o.useState({}),[l,d]=o.useState(0),h=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),p="http://localhost:8000";o.useEffect(()=>{let s=0;r.forEach(t=>{s+=n[t]||0}),d(s)},[r,n]),o.useEffect(()=>{let s=0;r.forEach(t=>{s+=n[t]||0}),d(s)},[r,n]);const u=s=>{fetch(`${p}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({Areas:s})}).then(t=>{if(!t.ok)throw new Error("サーバーエラー: "+t.statusText);return t.json()}).then(t=>{const a=parseFloat(t.price)||0;x(j=>({...j,[s]:a}))}).catch(t=>{console.error("Error:",t),c!=null&&c.user?(alert("金額取得に失敗したのでリロードします。お手数ですが再選択をお願いします。"),window.location.reload()):(alert("ログインしてください"),b.get(route("login")))})},f=s=>{i(t=>{const a=new Set(t);return a.delete(s),a})};return e.jsxs("div",{className:"h-[500px] flex overflow-hidden bg-gray-100",children:[e.jsxs("div",{className:"w-[25%] bg-gray-700 text-white p-1 sm:p-4 sm:w-[200px]",children:[e.jsx("div",{className:"flex items-center justify-center h-5",children:e.jsx("h1",{className:"text-[0.8rem] sm:text-[1.5rem] font-bold",children:"選択エリア"})}),r.size>0&&e.jsxs("div",{children:[e.jsxs("ul",{className:"mt-[10px] overflow-y-auto max-h-[350px]",children:[" ",Array.from(r).map(s=>{var t;return e.jsxs("li",{className:"bg-teal-600 px-1 py-0 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-lg text-[0.6rem] sm:text-[1rem]",children:s}),e.jsxs("div",{className:"mb-1 flex items-center justify-between text-[0.7rem] sm:text-[1rem] sm:mb-2",children:[e.jsxs("span",{children:["¥",(t=n[s])==null?void 0:t.toLocaleString()]}),e.jsx("button",{onClick:()=>f(s),className:"bg-red-500 text-white px-[1px] rounded-lg hover:bg-red-600 transition duration-200",children:"✕"})]})]},s)})]}),e.jsxs("p",{className:"text-[0.8rem] sm:text-[1rem] font-bold mt-2",children:["合計: ¥",l.toLocaleString()]}),e.jsxs("form",{method:"POST",action:"${baseUrl}/order",className:"mt-4",children:[e.jsx("input",{type:"hidden",name:"_token",value:h}),e.jsx("input",{type:"hidden",name:"total_price",value:l}),e.jsx("input",{type:"hidden",name:"areas",value:JSON.stringify(Array.from(r))}),e.jsx("button",{type:"submit",className:"bg-teal-600 text-white px-2 py-2 rounded-lg hover:bg-teal-700 transition duration-200 w-full mt-2 sm:px-6",children:"送信"})]})]})]}),e.jsx(g,{selectedAreas:r,setSelectedAreas:i,fetchAreaPrice:u,areaPrices:n,totalPrice:l})]})};export{v as default};
