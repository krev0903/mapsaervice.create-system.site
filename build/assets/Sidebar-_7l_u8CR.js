import{r as n,j as e}from"./app-CEhxmJXk.js";import p from"./Map-C19L1rM9.js";import"./index-BVGYi6r3.js";const g=()=>{const[r,l]=n.useState(new Set),[o,i]=n.useState({}),[a,c]=n.useState(0),d=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),m="http://localhost:8000";n.useEffect(()=>{let s=0;r.forEach(t=>{s+=o[t]||0}),c(s)},[r,o]),n.useEffect(()=>{let s=0;r.forEach(t=>{s+=o[t]||0}),c(s)},[r,o]);const x=s=>{console.log("送信するエリア名:",s),fetch(`${m}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({Areas:s})}).then(t=>{if(!t.ok)throw new Error("サーバーエラー: "+t.statusText);return t.json()}).then(t=>{const h=parseFloat(t.price)||0;i(u=>({...u,[s]:h}))}).catch(t=>{console.error("Error:",t),alert("金額取得に失敗したのでリロードします。お手数ですが再選択をお願いします。"),window.location.reload()})};return e.jsxs("div",{className:"h-screen flex overflow-hidden bg-gray-100",children:[e.jsxs("div",{className:"w-[160px] bg-gray-800 text-white p-4",children:[e.jsx("div",{className:"flex items-center justify-center h-5",children:e.jsx("h1",{className:"text-2xl font-bold",children:"選択エリア"})}),r.size>0&&e.jsxs("div",{children:[e.jsx("ul",{className:"mt-[10px]",children:Array.from(r).map(s=>{var t;return e.jsxs("li",{className:"bg-teal-600 px-1 py-0 rounded-lg",children:[e.jsx("div",{className:"font-semibold text-lg",children:s}),e.jsxs("div",{className:"text-xl mb-2",children:["¥",(t=o[s])==null?void 0:t.toLocaleString()]})]},s)})}),e.jsxs("p",{className:"text-xl font-bold mt-2",children:["合計: ¥",a.toLocaleString()]}),e.jsxs("form",{method:"POST",action:"${baseUrl}/order",className:"mt-4",children:[e.jsx("input",{type:"hidden",name:"_token",value:d}),e.jsx("input",{type:"hidden",name:"total_price",value:a}),e.jsx("input",{type:"hidden",name:"areas",value:JSON.stringify(Array.from(r))}),e.jsx("button",{type:"submit",className:"bg-teal-600 text-white px-6 py-3 rounded-lg hover:bg-teal-700 transition duration-200 w-full mt-2",children:"送信"})]})]})]}),e.jsx(p,{selectedAreas:r,setSelectedAreas:l,fetchAreaPrice:x,areaPrices:o,totalPrice:a})]})};export{g as default};
